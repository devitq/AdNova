apiVersion: 1

templates:
  - orgId: 1
    name: Telegram
    template: |
      {{ define "telegram.default.message" }} {{ if gt (len .Alerts.Firing) 0 }}
      ðŸ”¥ðŸš¨ *FIRE IN THE HOLE!* ðŸš¨ðŸ”¥
      We've got *{{ len .Alerts.Firing }} firing alert(s)* that need your immediate attention!
      {{ range .Alerts.Firing }}
      ---
      *Alert:* `{{ .Labels.alertname }}`
      {{ if .Labels.instance }}*Instance:* `{{ .Labels.instance }}`{{ end }}
      *Status:* ðŸ”´ *FIRING* since {{ .StartsAt.Format "2006-01-02 15:04:05 MST" }}

      {{ if .Annotations.summary }}*Summary:* {{ .Annotations.summary }}{{ end }}
      {{ if .Annotations.description }}*Description:* {{ .Annotations.description }}{{ end }}
      *Labels:*
      {{ range .Labels.SortedPairs }}  â€¢ `{{ .Name }}` = `{{ .Value }}`
      {{ end }}
      {{ if gt (len .Annotations) 0 }}*Annotations:*
      {{ range .Annotations.SortedPairs }}  â€¢ `{{ .Name }}` = `{{ .Value }}`
      {{ end }}{{ end }}

      {{ if .DashboardURL }}ðŸ“Š [View Dashboard]({{ .DashboardURL }})
      {{ end }}{{ if .PanelURL }}ðŸ“ˆ [View Panel]({{ .PanelURL }})
      {{ end }}{{ if .GeneratorURL }}ðŸ”— [Alert Source]({{ .GeneratorURL }})
      {{ end }}{{ if .SilenceURL }}ðŸ¤« [Silence Alert]({{ .SilenceURL }})
      {{ end }}--- {{ end }} {{ end }}
      {{ if gt (len .Alerts.Resolved) 0 }}
      âœ…ðŸŸ¢ *ALL CLEAR!* ðŸŸ¢âœ…
      Great news! *{{ len .Alerts.Resolved }} alert(s)* have been resolved.
      {{ range .Alerts.Resolved }}
      ---
      *Alert:* `{{ .Labels.alertname }}`
      {{ if .Labels.instance }}*Instance:* `{{ .Labels.instance }}`{{ end }}
      *Status:* âœ… *RESOLVED* at {{ .EndsAt.Format "2006-01-02 15:04:05 MST" }} (was active since {{ .StartsAt.Format "2006-01-02 15:04:05 MST" }})

      {{ if .Annotations.summary }}*Summary:* {{ .Annotations.summary }}{{ end }}
      {{ if .Annotations.description }}*Description:* {{ .Annotations.description }}{{ end }}
      *Labels:*
      {{ range .Labels.SortedPairs }}  â€¢ `{{ .Name }}` = `{{ .Value }}`
      {{ end }}
      {{ if gt (len .Annotations) 0 }}*Annotations:*
      {{ range .Annotations.SortedPairs }}  â€¢ `{{ .Name }}` = `{{ .Value }}`
      {{ end }}{{ end }}

      {{ if .DashboardURL }}ðŸ“Š [View Dashboard]({{ .DashboardURL }})
      {{ end }}{{ if .PanelURL }}ðŸ“ˆ [View Panel]({{ .PanelURL }})
      {{ end }}{{ if .GeneratorURL }}ðŸ”— [Alert Source]({{ .GeneratorURL }}) {{ end }} {{ end }} {{ end }}
      {{ if or (gt (len .Alerts.Firing) 0) (gt (len .Alerts.Resolved) 0) }}
      ðŸ”” *Grafana Alertmanager:* [View All Alerts]({{ template "__alertmanagerURL" . }}) ðŸ””
      {{ end }}
      {{ end }}
